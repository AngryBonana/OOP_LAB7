cmake_minimum_required(VERSION 3.10)

project(lab_07  # ‚Üê –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –∏–º—è –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∞–±–µ 7
    VERSION 1.0.0
    DESCRIPTION "LAB7"
    LANGUAGES CXX
)

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

set(INCLUDE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/include)
set(SRC_DIR ${CMAKE_CURRENT_SOURCE_DIR}/src)
set(TEST_DIR ${CMAKE_CURRENT_SOURCE_DIR}/test)

# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
set(SOURCES
    ${SRC_DIR}/main.cpp
    ${SRC_DIR}/npc.cpp
    ${SRC_DIR}/dragon.cpp
    ${SRC_DIR}/bull.cpp 
    ${SRC_DIR}/frog.cpp 
)

# === üî• –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: –Ω–∞–π—Ç–∏ –ø–æ—Ç–æ–∫–∏ ===
find_package(Threads REQUIRED)

# –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª
add_executable(lab_07_exe ${SOURCES})
target_include_directories(lab_07_exe PRIVATE ${INCLUDE_DIR})
target_link_libraries(lab_07_exe PRIVATE Threads::Threads)  # ‚Üê –≠–¢–ê –°–¢–†–û–ö–ê –ë–´–õ–ê –ü–†–û–ü–£–©–ï–ù–ê!

# –ü–æ–¥–∫–ª—é—á–∞–µ–º GoogleTest
include(FetchContent)
FetchContent_Declare(
    googletest
    GIT_REPOSITORY https://github.com/google/googletest.git  
    GIT_TAG        v1.15.0
)
FetchContent_MakeAvailable(googletest)

# –¢–µ—Å—Ç—ã
set(TEST_SOURCES
    ${TEST_DIR}/tests.cpp
    ${SRC_DIR}/npc.cpp
    ${SRC_DIR}/dragon.cpp
    ${SRC_DIR}/bull.cpp
    ${SRC_DIR}/frog.cpp
)

add_executable(lab_07_tests ${TEST_SOURCES})
target_include_directories(lab_07_tests PRIVATE ${INCLUDE_DIR})
target_link_libraries(lab_07_tests PRIVATE GTest::gtest GTest::gtest_main Threads::Threads)

# –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
include(GoogleTest)
gtest_discover_tests(lab_07_tests)

# –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
if(CMAKE_CXX_COMPILER_ID STREQUAL "GNU" OR CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
    target_compile_options(lab_07_exe PRIVATE -Wall -Wextra -Wpedantic)
    target_compile_options(lab_07_tests PRIVATE -Wall -Wextra -Wpedantic)
endif()